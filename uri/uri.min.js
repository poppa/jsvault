/*!
 * URI class
 * This class is for parsing, creating and manupulating a URI
 *
 * Copyright © 2009-2015 Pontus Östlund <https://profiles.google.com/poppanator>
 *
 * Permission to copy, modify, and distribute this source for any legal
 * purpose granted as long as my name is still attached to it. More
 * specifically, the GPL, LGPL and MPL licenses apply to this software.
 */
!function(){"use strict";window.URI=function(t){this.scheme=null,this.host=null,this.username=null,this.password=null,this.port=null,this.path=null,this.query=null,this.fragment=null,this.variables={};var s={ftp:21,ssh:22,telnet:23,smtp:25,http:80,https:443,mysql:3306},i=encodeURIComponent,n=decodeURIComponent;this.queryToObject=function(t){if(!t||!t.length)return null;var s,i,e,h,r,u={};for("?"===t[0]&&(t=t.substring(1)),s=t.split("&"),i=0;i<s.length;i++)e=s[i].split("="),1!==e.length?(h=n(e[0]),r=n(e[1]),u[h]?("string"==typeof u[h]&&(u[h]=[u[h]]),u[h].push(r)):u[h]=r):u[n(e[0])]="";return u},this.parse=function(t){var i,n,e=0,h=t;(e=h.indexOf("://"))>-1&&(this.scheme=h.substring(0,e),h=h.substring(e+3)),(e=h.indexOf("#"))>-1&&(this.fragment=h.substring(e+1),h=h.substring(0,e)),(e=h.indexOf("?"))>-1&&(this.query=h.substring(e+1),h=h.substring(0,e)),(e=h.indexOf("/"))>-1?(this.path=h.substring(e),h=h.substring(0,e)):this.scheme||(this.path=h,h=null),this.variables=this.queryToObject(this.query)||{},h&&0!==h.length&&((e=h.indexOf("@"))>-1&&(i=h.substring(0,e),i.indexOf(":")>-1?(n=i.split(":"),this.username=n[0],this.password=n[1]):this.username=i,h=h.substring(e+1)),(e=h.indexOf(":"))>-1&&(this.port=parseInt(h.substring(e+1),10),h=h.substring(0,e)),!this.port&&this.scheme&&(this.port=s[this.scheme]),this.host=h)},this.queryString=function(){var t,s,n,e,h,r,u=[];for(var l in this.variables)if(null!==(s=this.variables[l])){if("string"!=typeof s){for(n=[],r=0;r<s.length;r++)e=s[r],null!==e&&(h=i(l),e.length>0&&(h+="="+i(e)),n.push(h));t=n.join("&")}else t=i(l),s.length>0&&(t+="="+i(s));u.push(t)}return u.length&&u.join("&")||null},this.toString=function(){e(this.port)&&(this.port=s[this.scheme]);var t="",i=this.queryString();return this.scheme&&(t=this.scheme+"://"),this.username&&(t+=this.username),this.username&&this.password&&(t+=":"),this.password&&(t+=this.password),this.username&&(t+="@"),this.host&&(t+=this.host),this.isDefaultPort()||(t+=":"+this.port),this.path&&(t+=this.path),i&&(t+="?"+i),this.fragment&&(t+="#"+this.fragment),t};var e=function(t){for(var i in s)if(s[i]===t)return!0;return!1};this.isDefaultPort=function(){if(!this.port)return!0;for(var t in s)if(t===this.scheme&&this.port!==s[this.scheme])return!1;return!0},t&&t.length>0&&this.parse(t)}}();